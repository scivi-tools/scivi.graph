<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8"/>
        <title>SciViGraph</title>
        
        <script src="../../lib/pixi.js"></script>
        <script src="../../lib/jquery.js"></script>
        <script src="../../lib/jquery-ui.js"></script>
        <script src="../../lib/split.min.js"></script>
        <script src="../../lib/louvain.min.js"></script>
        <script src="../../lib/chart.min.js"></script>

        <link rel="stylesheet" href="../../css/jquery-ui.css"/>
        <link rel="stylesheet" href="../../css/default.css"/>

        <script src="data.js"></script>
        <script src="../../css/colors.js"></script>
        <script src="../../build/scivi-cgraph.js"></script>

        <script>
            function main()
            {
                var parser = new SciViGraph.Parser(g_data);
                var renderer = new SciViGraph.Renderer($('#view')[0], $('#info')[0], 
                                                       $('#list')[0], $('#settings')[0], 
                                                       $('#stats')[0]);

                var nodes = parser.nodes;
                var edges = parser.edges;

                Split(['#a', '#b'], {
                      gutterSize: 8,
                      cursor: 'col-resize',
                      onDrag: () => { renderer.reshape(); }
                });

                $("#tabs").tabs({heightStyle: "fill"});

                console.log("Number of nodes: " + nodes.length);
                console.log("Number of edges: " + edges.length);

                nodes.sort((x1, x2) => {
                    if (x1.date < x2.date)
                        return -1;
                    else if (x1.date > x2.date)
                        return 1;
                    else
                        return 0; 
                });

                Louvain.detectClusters({nodes: nodes, edges: edges});

                var steps = [
                    new Date("09/01/2016"),
                    new Date("10/01/2016"),
                    new Date("11/01/2016"),
                    new Date("12/01/2016"),
                    new Date("01/01/2017"),
                    new Date("02/01/2017"),
                    new Date("03/01/2017"),
                    new Date("04/01/2017"),
                    new Date("05/01/2017"),
                    new Date("06/01/2017"),
                    new Date("07/01/2017"),
                    new Date("08/01/2017"),
                    new Date("09/01/2017"),
                    new Date("10/01/2017"),
                ];
                var colors = [
                    0xdd1111,
                    0x5dc8cd
                ];
                var textColors = [
                    0xffffff,
                    0x000000
                ];
                var names = [
                    "2016-",
                    "Сентябрь 2016",
                    "Октябрь 2016",
                    "Ноябрь 2016",
                    "Декабрь 2016",
                    "Январь 2017",
                    "Февраль 2017",
                    "Март 2017",
                    "Апрель 2017",
                    "Май 2017",
                    "Июнь 2017",
                    "Июль 2017",
                    "Август 2017",
                    "Сентябрь 2017",
                    "Октябрь 2017",
                    "2017+"
                ];
                var scale = new SciViGraph.Scale(steps, colors, textColors, names, (node) => { return node.date; });

                renderer.setInput(nodes, edges, g_colors);
                renderer.scale = scale;
                renderer.run();
            }
        </script>
    </head>

    <body onload="main();">

        <div id="a" class="split split-horizontal">
            <div id="view"></div>
        </div>
        <div id="b" class="split split-horizontal">
            <div id="tabs">
                <ul>
                    <li><a href="#info">Информация о вершине</a></li>
                    <li><a href="#list">Вершины</a></li>
                    <li><a href="#settings">Настройки</a></li>
                    <li><a href="#stats">Группы</a></li>
                </ul>
                <div id="info"></div>
                <div id="list"></div>
                <div id="settings"></div>
                <div id="stats"></div>
            </div>
        </div>
        
    </body>
</html>
